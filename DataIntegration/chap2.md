## 以下内容刘奕彤编写
### 2.4.3 比较数据建模(Ⅰ)

首先考虑一种比较数据建模的方法，它可以与FS范式下的概率记录联系起来。在保持普遍性的同时，让$g_a^*=h$作为$a \in A$的完整比较数据，同时$g_b^*=j$作为$b \in B$的完整比较数据，对于h,j=1,…,K 。正如Stoerts et al.（2015）等人，我们假定比较数据的潜在失真在实体之间是独立的，因此
$f(G^*|ω)= \prod\limits_{(ab) \in M}f(g_a^*,g_b^*|ω_ab=1) \prod\limits_{a \in U_B}f(g_a^*|a \in U_A) \prod\limits_{b \in U_B}f(g_b^*|b \in U_B)$

请注意，原则上，数据链接者可以提供这些概率作为比较数据，而不用披露关键变量。
当只有比较数据$G=\{g_{ab};a \in A_L,b \in B_L\}$ \\可用时，也就是实践中最有可能出现的情况，此时，可以从整合出$g_a^*$和$g_b^*$在完整的比较数据模型中的$g_a^*$和$g_b^*$进行积分，从而得到:

$f(G|\omega )= \prod\limits_{(ab):\omega_ab=1}f(g_ab|\omega_ab=1)$(2.3)

为了建立相关的概率模型，考虑Copas和Hilton（1990）提出的命中-失误失真模型模型，该模型由Copas和Hilton（1990）提出。设想一个二进制试验导致概率为$\alpha$的失误，随后观察到的值h是以概率$p_h$随机分布的，其中$p_h$是真实值h的频率。让$K=n_A +n_B-m$是A和B中实体的数量，其中$m=|M|$。假设所有实体的完整比较数据是不同的，因此以便$p_h=1/K$。对于一个简单的比较数据模型，让为协议指标。我们有:

$\mu_{ab}=f(g_{ab}=1|\omega_{ab}=1)=(1-\alpha)^2+2\alpha(1-\alpha)/K+\alpha^2/K$

$\mu_{ab}^c=f(g_{ab}=0|\omega_{ab}=1)=1-\mu_{ab}=(1-(1-\alpha)^2)(1-1/K)$

这可能被称为可交换协议（EA）模式。次要的分析师只需要提供K（或m）的估计值。

似乎很直观的是，在适当的条件下，EA模型可以产生ELE模型。适当的条件下，EA模型可以产生ELE模型。例如，假设一对一完全匹配，其中综合数据的分析h,j = 1,……,n 和$U_A = U_B =∅ $。在 EA 模型下，让$ \mu_ab=\mu(\alpha)$，其中$ g_{ab}$是协议指标。假设记录连接进行如下进程：如果它们是唯一一致的，则链接(ab)；如果没有唯一一致的记录，则随机链接记录中随机链接，但要遵守一对一的链接约束。这将导致ELE模型，其参数为$\lambda(\alpha,\phi)=q_{ii}=f(P_{ii}=1|\omega_{ii}=1)$, 其中$\omega=I_{n \times n}$的定义。

| $\alpha$ | n=3


| n=10 | n=50        | n=300       | n=1000      |             |             |
| ---- | ----------- | ----------- | ----------- | ----------- | ----------- |
| 0.02 | 0.974/0.987 | 0.965/0.981 | 0.961/0.975 | 0.961/0.964 | 0.960/0.962 |
| 0.05 | 0.935/0.966 | 0.912/0.950 | 0.904/0.925 | 0.903/0.910 | 0.903/0.907 |
| 0.10 | 0.873/0.937 | 0.829/0.895 | 0.814/0.846 | 0.811/0.827 | 0.810/0.824 |
| 0.20 | 0.760/0.878 | 0.676/0.790 | 0.647/0.712 | 0.641/0.691 | 0.640/0.688 |

虽然$\mu(\alpha)$有一个封闭的表达式，但$\lambda(\alpha,\phi)$只能通过G的蒙特卡洛模拟和随后的联系程序获得$\phi$。表2.2提供了$\mu$和$\lambda$给定的$\alpha$和n之间的比率，其中每个都是基于5000次模拟的结果。显然，在所有情况下$\mu /\lambda<1$。在一端，观察在任何固定的情况下，$\mu /\lambda→1$为$n\longrightarrow\infty$，因为在失误之后达成一致的机会趋于零，同时也趋于零。错过的机会趋向于零，而通过随机连接匹配的机会也是如此。在另一端，对于较小的n和较大的 ，$\mu /\lambda$进一步远离1，其中在这里，一对一联系限制的效果直观上是最强的。

表2.3

对于比较模型下的线性回归的一个非常简单的说明模型（2.3）下的线性回归，假设n=3的一对一完全匹配。矩阵$Q_G$为$\beta_G$由（2.2）取决于观察到的G。表2.3给出了两个例子。
$\alpha=0.02$时，观察到$G_1$的概率$f（G_1|\omega）$是0.923$G_1$，鉴于此
$\beta_G$的效率几乎与已知的$\omega$一样，因为$Q_G \approx I$ 。当$\alpha =0.1$观察到$G_1$的概率下降到0.666。回归的有效性低于$G=G_2$，从相应的$Q_G$可以看出。差异根植于$f(G|\omega)=\mu^{d}(1-\mu)^{n-d}$ 其中是观察到的$M(\mu)$的吻合度。让$d_0(G)$为给定G下最大可能的d，当$d_0(G_1)=3$且$d_0(G_2)=2$事，我们有：

$\sum_{\omega\in\Omega}f(G|\omega)=\sum_{d=0}^{d_{0}(G)}m_{d}f_{d}$

其中$f_d=f(G|\omega)$对于任何具有相同d的$\omega$来说是相同的，$m_d$是这样的数量$\omega's$. 似然比为$f_{d+1}/fd=\mu/(1-\mu)$.由$G_1$引起的协议分区是$m_d=(2,3,1)$，对于d=(0,1,3)，并且$\omega=G_1$的可能性是$f_3$,是次高的$f_1$的$\mu^2/(1-\mu)^2$倍。而鉴于$G_2$，我们有$m_d=(2,2,2)$，因为$d=(0,1,2)$，其中有两个$\omega's$最高的可能性$f_2$，是次高$f_1$的$\mu/(1-\mu)$倍。观察到$G=G_2$的不确定性显然大于$G=G_1$。

### 2.4.3 比较数据建模(Ⅱ)

在实践中，多通道的确定性联系是很常见的。让$L_k = A_k\times B_k$包含
k=1,…,K的第k次传递的$n_k$个链接。这些是在第k次传递中彼此完全一致的记录。没有链接的的记录留待以后的检验。让$A_0$包含A和$B_0$中的记录。联系的结果是分区:

$A\times B=\bigcup_{k=0}^{K}\bigcup_{j=0}^{K}A_{k}\times B_{j}$

让$g_{ab} = (k, j)$表示记录对(ab)属于分区的这些域的集合构成了比较数据G。

对于任何$（ab）\in  L_k$，让$\pi_{k}=\,f\bigl(\omega_{a b}\,=\,1\vert g_{a b}\,=\,(k,k)\bigr)$，这样，$1-\pi_{k}$   是$L_k$中的FLR（如表2.1）。我们有

$\mu_{a b}=f{\big(}g_{a b}=(k,k)|\omega_{a b}=1{\big)}=\pi_{k}f{\big(}g_{a b}=(k,k){\big)}/f(\omega_{a b}=1)$

人们可以通过$\pi_k n_k/m$来估计$\mu_{ab}$。理想情况下，我们希望数据提供者
能够提供$\mu_{a b}=\,f\bigl(g_{a b}=(k,j)\bigr)\bigl\vert\omega_{a b}=\,1\,\bigr)$对所有其他的组合

(k, j)也是如此。然而，这在实践中可能是很苛刻的。作为一个可能的
简化，让$L=\bigcup_{k=1}^{K}L_{k}$包含所有的链接对，并让

$\mu_{a b}=f\Bigl((a b)\ll L|\omega_{a b}=1\Bigr)=1-\sum_{k=1}^{K}f\Bigl(g_{a b}=(k,k)|\omega_{a b}=1\Bigr)$

其中假定$g_{ab}$在连接对之外的均匀分布。

当然，上述比较模型是对现实的极大简化。
因为匹配不可能均匀地分布在
$R = (A\times B) / L$。事实上，在所有未链接的记录对中，我们可以期待
预计$m_{R}=m-\sum_{k=1}^{K}\pi_{k}n_{k}$的匹配。我们可以探索$\mu_{ab}$的界限.例如，让$R_k$成为R的子集，其中涉及$a \in A_k$或$b \in B_k$，在这里我们最多可以期待$2n_{k} 1-\pi_{k})$匹配。因此，

$ f{\bigl(}(a b)\in R_{k}{\vert}\omega_{a b}=1{\bigr)}\leq2(1-\pi_{k})n_{k}/mf$，这就提供了一个$\mu_{ab}$在$R_k$上的上限.此外，让$R_0=A_0 \times B_0$，其中可以预期至少有

$m_{R}-2\sum_{k=1}^{K}(1-\pi_{k})n_{k}$k的匹配，因此$\mu_{ab}$在$R_0$上的下限是

$R_{0}|\omega_{a b}=1\rangle\geq1-\sum_{k=1}^{K}(2-\pi_{k})n_{k}/m$

让我们考虑C-PR的情况来说明。让$n_A$是人口普查数据集的大小，$n_B$是病人登记册的大小。让$n_L$是链接的数量（表2.1），m为匹配实体的数量。为了便于理解，假设m=51，nA=53，nB=55，都是以百万计。

* 对于第k个确定性通道，其中k=1,…9，FLR $1 -\pi_k$给出如表2.1我们设定  $\mu_{ab} = \pi_k n_k/m$ 为$（ab）\in  L_k$。

- 除了表2.1之外，我们没有其他关于两个概率性，分别用$L_10$和$L_11$表示。因此我们把它们就像从确定的联系中产生的一样。
- 我们还计算了$R_k$中的上界概率$\mu_{ab}$，和$R_0$中的下限概率 ˜$\mu_{ab}$。

表2.4

当涉及到大型人口时，可扩展性是一个重要的问题，比如在C-PR案例中。考虑一下评估的一般任务：

$E(t_{\omega}|G)=\sum_{\Omega}t_{\omega}f(\omega|G)=\sum_{\Omega}t_{\omega}f(G|\omega)/\sum_{\Omega}f(G|\omega)$

此时$t_\omega$ 是$\omega$的一个函数，正如在2.2中作为$Q_G$的$t_\omega=\omega^T$

完整列举$\omega$在大多数情况下是不可行的。让我们从$\omega$
中去一个样本$ s=\{\omega_{1},...,\omega_{n_{\circ}}\}\subset\Omega$.如果对$\omega's$进行随机抽样，那么H´ajek类型的估计是$E(t_\omega|G)$是$\bar{t}_{H}:=\sum\omega{\in}s\,t_{\omega}f(G|_{c o})/{\sum}\omega{\in}s\,f(G|_{c o})$而如果$\omega\sim f(\omega|G)$,蒙特卡洛估计是$\bar{t}=\sum_{\omega\in s}t_{\omega}/n_{s}$ 。Metropolis-Hastings算法提供了一种解决后者的一般方法：在每一步中从当前的中提出一个新的$\omega's$，其中的提议是对称的，接受率为$min|\{1,\;f(\omega^{\prime}|G)/f(\omega|G)\}.$

在上面的比较数据模型下，我们可以直接分析C-PR联系数据的接受率。让$\omega=\omega_L$ 为与链接矩阵完全一致的匹配矩阵，其中当且仅当$(ab) \in L $时$\omega_{ab}=1$。在以下子矩阵中得到了一般性的描述$\{a,a^{\prime},a^{\prime\prime}\}\times\{b,b^{\prime},b^{\prime\prime}\}$:

$[\omega_{L}]=\left[\begin{array}{c c c}{{1}}&{{0}}&{{0}}\\ {{0}}&{{1}}&{{0}}\\ {{0}}&{{0}}&{{0}}\end{array}\right]$

$[\omega_{1}]=\left[\begin{array}{c c c}{{1}}&{{0}}&{{0}}\\ {{0}}&{{1}}&{{0}}\\ {{0}}&{{0}}&{{1}}\end{array}\right]$

$[\omega_{2}]=\left[\begin{array}{c c c}{{0}}&{{0}}&{{1}}\\ {{0}}&{{1}}&{{0}}\\ {{0}}&{{0}}&{{0}}\end{array}\right]$

$[\omega_{3}]=\left[\begin{array}{c c c}{{0}}&{{1}}&{{0}}\\ {{1}}&{{0}}&{{0}}\\ {{0}}&{{0}}&{{0}}\end{array}\right]$

其中$1\leq k\neq k^{\prime}\leq11$ $(ab) \in L_K$

每一矩阵中的第一行是子向量$(\omega_{a b},\omega_{a b^{\prime}},\alpha_{a b^{\prime\prime}})$，第二行和第三行也是如此.

* $\omega_L$和$\omega_1$之间的唯一区别是，$\omega_1$包含一个额外的匹配 (a'',b'')。根据表2.4,我们有$f(\omega_{1}|G)/f(\omega_{L}|G)=\mu_{a b;0}=0.0100,$，或者至少是0.0055.
* 根据$\omega_2$，$R_k$中的一对实际上是一个匹配，而不是$L_k$中的一对。有$f(\omega_{2}|G)/f(\omega_{L}|G)=f{\big(}(a b^{\prime\prime})\in R_{k}|\omega_{a b^{\prime}}=1{\big)}/\mu_{a b;k}\leq{\tilde{\mu}}_{a b;k}/\mu_{a b;k}$，这对于表2.4中的所有1＜k＜ 11接近于零。
* 对于$\omega_3$，$L_k$中的(ab)和$L_{k'}$中的(a',b')是错误的链接，而$R_k$中的(ab')和(a'b)匹配未能被链接。而$R_k$中的(ab')和$R_{k'}$中的(a'b)不能被链接。我们有$f(\omega_{3}|G)/f(\omega_{L}|G)\ \leq\tilde{\mu}_{a b;k}\tilde{\mu}_{a b;k^{\prime}}/\mu_{a b;k}\mu_{a b;k^{\prime}}$这对所有$1\leq k\mp k^{\prime}\leq1^{\circ}$来说几乎是零。

因此，Metropolis-Hastings算法在数值上是不够有效的。考虑到$m>n_L$，匹配矩阵有$\omega_L$ 作为链接记录的子矩阵，再加上$m-n_L$在$A_0 \times B_0$之间的额外匹配,都有相同的可能性。这种矩阵的数量是$\left((n_{A}-n_{L})!/(n_{A}-m)!\right)\Bigl((n_{B}-n_{L})!/(n_{B}-m)!\Bigr)/(m-n_{L})!$

在结果空间如此之大的情况下，任何对$f(\omega|G)$的再抽样方法都是非常不切实际的。

