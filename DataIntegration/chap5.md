以下内容为杜博玮所做：

### **5.2.4 惩罚性不确定性测量**

在介绍过程之前，让我们引入一些符号。假设Q是所有可用X变量的数量， $H_q$ 是变量 $X_q$ 的类别数。此外， ${D_m}$ 是通过交叉分类共同变量的子集而获得的变量，其中 $HD_m$ 是其类别数；可以创建的子集总数为 $M = (2^{Q}-1)$，而最终子集包括所有Q变量，即 $D_Q= X_1 × X_2 × ... × X_Q$，并且具有 $HD_Q$ 类别数 $（HD_Q = H_1 × H_2 × ... × H_Q）$。匹配变量是与 $D_m$ 相对应的变量，使得在所有可能的变量组合中，d的惩罚度量最小化。更正式地说，假设g是惩罚项，我们寻找最小值 

$\tilde{d_m} = d_m+ g$  (5.3) 

特别地，我们分析了两个替代惩罚度量，两个都基于稀疏性度量。第一种是

$\tilde{d_m}^{(1)}=dm+log(1+\frac{HD_m}{HD_Q})$ (5.4)

的最小值，并且我们搜索˜d的最小值 (1)  m的最小值，使其具有可接受的稀疏程度。
例如，如果稀疏性是由以下因素衡量的

$\bar{n}=min[\frac{n_A}{HD_m×J},\frac{n_B}{HD_m×K}]$ (5.5)

其中， $HD_m×J$和 $HD_m×K$ 分别是表格 $D_m×Y$和 $D_m×Z$ 中的单元格数，因此我们可以要求可接受的子集是那些 $\bar{n}>1$ 的子集。在这个函数中，稀疏性分为两部分，在惩罚项 $log(1+\frac{HD_m}{HD_Q})$ 中考虑了变量X的稀疏性，并在停止规则中要求 $\bar{n}> 1$，即与(Y，X)和(Z，X)相关的稀疏性。引入对数是因为从进行的实验中观察到，这个项的增长速度（不带对数）相对于 $d_m$来说太快了。

第二个惩罚性措施是

$\tilde{d_m}^{(2)}=dm+max[\frac{1}{N_A-HD_m×J},\frac{1}{n_B-HD_m×K}]$  (5.6)

其中， $n_A>(HD_m×J)$ 并且 $n_B>(HD_m×K)$

第二个惩罚项的优点是不依赖于最大表格的所有可用 X 变量的单元数 ( $HD_Q$ )，此时交叉时所得到的。此外，第二个惩罚隐含地包含了这个停止准则，即当 $\bar{n} ≤ 1$ 时停止，表示过于稀疏的列联表的指示。这当然是 $\tilde{d_m}^{(2)}$  的一个积极方面，另一方面， $\tilde{d_m}^{(1)}$ 更加灵活，因为它允许采用不同的稀疏度度量和停止规则中的不同阈值。事实上， $\bar{n}>1$ 的标准是一个主观选择，反映了[2]中关于稀疏性的广泛定义：“当样本大小与单元数的比例相对较小时，列联表被认为是稀疏的”。然而，在文献中，许多其他的方法被提出来衡量稀疏性，例如，基于期望单元频率小于1、5或10的百分比，或者观察到的零频率的百分比。这些指标可以代表惩罚项的替代提案。
当许多共同变量表征问题时，惩罚度量的最小化计算可能是不可行的；因此，提出了一种顺序过程来近似先前的计算。

该过程包括以下步骤：

• 步骤 0 
将 Q 个变量 $X_q$ 按照相对于 $\tilde{d_q}$ 的降序排序。然后选择具有最小 $\tilde{d_q}$ 的变量。 

• 步骤 1 
考虑将一个变量添加到当前已选择的变量集合中得到的所有可能组合，并以 $\tilde{d_m}$ 为标准评估相应的不确定性；例如，在第一次迭代中，将考虑使用步骤 0 中识别的变量与其他变量的所有可能组合。 

• 步骤 2 
选择具有最小 $\tilde{d_m}$ 值的变量组合，然后如果满足以下任一条件之一，则停止：

i) $\tilde{d_m}$  大于前一次迭代对应组合的值，即不存在返回 $\tilde{d_m}$ 下降的变量组合

ii) （仅在使用 $\tilde{d_m}^{(1)}$ 的情况下需要的步骤）稀疏度不可接受，例如使用公式（5.5）中的 $\bar{n} ≤ 1$ ;

否则返回步骤 1。


## **5.3使用欧洲社会调查数据进行模拟**
为了展示选择匹配变量的方法如何工作，考虑一个玩具示例，其中数据来自于欧洲社会调查（ESS，2014）第七轮。数据集仅包括社会人口核心模块的一部分变量，已经排除了缺失值、“不知道”和拒绝回答的样本。总之，共有 n = 28,769 个受访者和 13 个变量（见表5.1）。表5.1中的后两个变量起着目标变量（Y=“hincfel1”和Z=“hinctnta”）的作用，而其他变量则作为可用的共同变量（X）进行处理。最初，我们将使用整个样本来选择匹配变量，在真实的SM应用中不存在这种情况，那里只有包括 (X,Y) 和 (X,Z) 两个独立样本 A 和 B。
在第一步，我们通过计算通常的成对度量来寻找最理想的预测目标变量的最佳预测变量集合，这是通过交叉两个目标变量（即W = Y × Z）获得的，因为它基于（X，Y，Z）的联合分布的全面了解。结果报告在表5.2中。特别地，通过考虑每个可用的X，计算了经过偏差校正的Cramer's V、Theil's U和AIC。


### **TABLE 5.1**

描述所使用模拟中的变量。

| 名称 | 描述 | 
| :----: | :-- | 
| cntry |  居住国家（20个国家） | 
| hhmmb5  | 家庭成员数（1、2、3、4、>4） | 
| gndr | 受访者的性别（1=“男性”，2=“女性”） |
| ageacat | 受访者年龄类别（14-17、18-24、25-44、45-64、65-74、>74） |
| icpart1 | 受访者是否与配偶/伴侣同住（1=“是”，2=“否”） |
| chldhm | 家庭中是否有子女（1=“是”，2=“否”） |
| anypacc | 住房是否存在问题（1=“是”，2=“否”） |
| eisced | 受教育程度最高水平（7个类别） |
| prof2 | 职业状态（1=“有薪工作”，2=“退休”，3=“其他”） |
| crpdwk | 过去7天是否从事过有薪工作（至少1小时）（具有prof2=1或2的人） |
| emplrel | 工作类型（具有prof2=1的人）（1=“雇员”，2=“自雇”，3=“在家庭企业工作”） |
| hinctnta | 家庭总收入的十分位数（1-10） |
| hincfel1 | 是否因当前收入而生活舒适（1=“是”，2=“否”） |


### **TABLE 5.2**

W=(Y × Z)和每个可用的X之间的关联、PRE度量和AIC。 

| X | V' | U | AIC |
| :----: | :----: |:----: |:----: |
| cntry | 0.1117 | 0.0409 | 158818.1 |
| hhmmb5 | 0.2380 | 0.0393 | 158507.0 |
| gndr | 0.0966 | 0.0018 | 164575.4 |
| ageacat | 0.1312 | 0.0153 | 162495.1 |
| icpart1 | 0.3878 | 0.0267 | 160463.2 |
| chldhm | 0.2539 | 0.0119 | 163901.5 |
| anypacc | 0.1479 | 0.0038 | 164231.6 |
| eisced | 0.1785 | 0.0328 | 159653.6 |
| prof2 | 0.2805 | 0.0278 | 160321.4 |
| crpdwk | 0.2606 | 0.0251 | 160771.1 |
| emplrel | 0.0688 | 0.0025 | 164522.7 |

在这个表中，我们看到了每个可用的X与目标变量 $W = (Y × Z)$之间的关联程度、PRE度量和AIC值。其中，偏差校正的Cramer's V表明，与目标变量组合 $（W = Y × Z）$相关性最高的变量是“icpart1”，其次是“prof2”、“crpdwk”、“chldhm”和“hhmmb5”，它们的相关性较低。如果考虑Theil's U或AIC，则可能会得出略有不同的变量子集，特别是“cntry”、“hhmmb5”、“eisced”，以及具有较小值的“icpart1”、“prof2”和“crpdwk”。当使用AIC来识别最佳的X组合来预测 $W = Y × Z$时，返回第一选择的子集只包含变量“hhmmb5”和“cntry”，其次是（“hhmmb5”，“eisced”）和（“hhmmb5”，“cntry”，“icpart1”）。这些结果表明，即使在具有所有变量（X，Y，Z）的唯一数据源中，在不考虑预测因素之间的关系的情况下，成对测量结果会建议选择比必要的预测因素更多的预测因素。

本文介绍了在标准匹配中，当两个不同样本可用时，如何展示基本分析工作的例子。这代表了在标准匹配中的理想情况，其中双变量分布（X，Y）和（X，Z）已知。所有的测量结果（见表5.3）都指出“cntry”和“eisced”是“hincfel1”（Y）的最佳预测变量。相反，当响应变量是“hinctnta”（Z）时，结果不完全一致；如果比较估计的U和AIC，可以确定一个更大的匹配变量子集（“hhmmb5”，“icpart1”，“eisced”，“prof2”，“crpdwk”），而如果比较V 0，则只有一个较小的子集（“icpart1”，“prof2”，“crpdwk”）是最佳选择。
   假设 $X_Y = (“cntry”, “eisced”) $和 $X_Z = (“hhmmb5”, “icpart1”, “eisced”, “prof2”, “crpdwk”)$，它们的交集确定了一个子集，仅包含一个匹配变量 $X_M = “eisced”$；相反，它们的并集返回一个包含六个匹配变量的集合（“cntry”, “hhmmb5”, “icpart1”,“eisced”, “prof2”, “crpdwk”）。


### **TABLE 5.3**

该表格展示了Y（“hincfel1”）和Z（“hinctnta”）对所有可能的X的组合之间的关联（V）、PRE度量和AIC值。

| X | V' | U | AIC | V' | U | AIC | 
| :----: | :----: |:----: |:----: | :----: | :----: | :----: |
| cntry | 0.3567 | 0.1027 | 33427.9 | 0.0898 | 0.0168 | 130381.1 |
| hhmmb5 | 0.0960 | 0.0073 | 36948.6 | 0.2260 | 0.0436 | 126565.4 |
| gndr | 0.0488 | 0.0019 | 37144.6 | 0.0915 | 0.0019 | 132020.9 |
| ageacat | 0.0411 | 0.0014 | 37170.3 | 0.1149 | 0.0150 | 130367.3 |
| icpart1 | 0.1008 | 0.0080 | 36916.6 | 0.3849 | 0.0327 | 127949.7 |
| chldhm | 0.0529 | 0.0022 | 37132.2 | 0.2077 | 0.0097 | 130994.3 |
| anypacc | 0.1096 | 0.0100 | 36844.0 | 0.1285 | 0.0035 | 131815.9 |
| eisced | 0.2385 | 0.0438 | 35593.3 | 0.1715 | 0.0376 | 127395.2 |
| prof2 | 0.1343 | 0.0146 | 36672.0 | 0.2716 | 0.0326 | 127981.4 |
| crpdwk | 0.1143 | 0.0103 | 36834.4 | 0.2596 | 0.0308 | 128211.3 |
| emplrel | 0.0564 | 0.0026 | 37120.1 | 0.0663 | 0.0028 | 131943.9 |


