# 7.1 介绍

在很多情况下我们都想知道人口的数量；但是，有关该人口的信息并不完善。一种众所周知的估计人口规模的技术是找到两个或多个数据源或登记册，这些数据源或登记册可以识别感兴趣的人口成员，将登记册中的个人链接起来，并使用链

接的信息来估计出现的个人数量在这两个登记册中都没有（Fienberg [10]、

Bishop、Fienberg 和 Holland [4]、Cormack [7]、国际疾病监测和预测工作组、

IWGDMF [15]；另请参阅本卷的第 8 章和第 9 章di Cecco [8] 和 Zhang [31])。例如，对于两个寄存器 A 和 B，链接给出 A 中但不在 B 中的个体计数，B 中但不在 A 中的个体计数，以及 A 和 B 中的个体计数。这些计数构成了一个偶然事件由 A B 表示的表，其中标记为 A 的变量是“包含在寄存器 A 中”的缩写， 采用水平“是”和“否”，寄存器 B 也是如此。在此表中，根据定义，单元格“否，否”的计数为零，统计问题是估计此中感兴趣的总体规模细胞。这一估计被添加到至少在一个登记册中发现的个人×数 量，相对于仅使用在至少一个登记册中观察到的人数，给出了改进的人口规模估计。 对于具有两个或多个来源的双系统和多系统估计，获得人口规模估计的通常假设是 

• 人口封闭 

 • 寄存器 A 和 B 中的个人可以完美链接双系统和多系统估计    • 没有因不属于目标人群的个人而造成的过度覆盖 此外，还有两个寄存器：  • 列入登记册 A 独立于列入登记册 B；和  • 在两个寄存器中的至少一个中，包含概率是同质的（参见 Chao 等人 [6]、Zwane、 van der Pal-de Bruin 和 van der Heijden [35] 以及 van der Heijden 等人  [27]） .有趣的是，通常但错误地假设两个寄存器中的包含概率必须是同质的。 然而，人们普遍认为这些假设不太可能适用于人类。可以采用三种方法来减轻可能的 违规行为的影响。 一种方法是在模型中包括分类协变量，特别是其水平对两个寄存器具有异质包含 概率的协变量（参见 Bishop、Fienberg 和 Holland [4] 以及 Baker [2] 的人群方 法，并与 Pollock [20] 进行比较] 谁审查在动物种群中的应用）。然后可以将对数 线性模型拟合到寄存器 A 和 B 以及协变量的高阶列联表。双源估计中的限制性独立 性假设被限制性较小的 A 和 B 以协变量为条件的独立性假设所取代；和亚种群规模 估计值（协变量的每个水平都有一个）加起来就是种群规模估计值。在人口登记的对 数线性模型中包括协变量可以改进人口规模估计，原因有两个。首先，它考虑了协变 量水平上包含概率的异质性；其次， 它根据协变量的水平细分估计人口（以及因此估 计的未观察到的人口部分），从而深入了解未包含在任何登记册中的个人特征。第二种方法是包括第三个寄存器，并使用可能包含一个或多个双因素交互作用的 对数线性模型来分析生成的三向列联表，从而对相关性进行建模并避免对独立性假设 的需要。需要不存在三因素相互作用的（不太严格的）假设，因为无法从观察到的数 据中估计这种相互作用。包括第三个登记册并不总是可行的，因为它不可用，或者因 为没有信息可以将第三个登记册中的个人链接到其他两个登记册。 第三种方法利用潜在变量来考虑包含概率的异质性（参见 Fienberg、Johnson 和  Junker [11]、Bartolucci 和 Forcina [3]）。这些作者使用 Rasch 模型，这是一 种常用于心理测量学的模型。该模型假设一个连续的潜在变量，并且给定潜在变量， 包含概率是独立的。潜在变量的较低位置导致所有包含概率 较低和较高的位置导致所有包含概率较高。例如，如果数据涉及四个不同的医疗登记， 则潜在变量可以解释为疾病的严重程度，其中严重程度较高的患者具有较高的纳入概 率。当然，这三种方式并不排斥，可以在一个模型中同时使用。当采用的方法包括使 用协变量时，就会出现应选择哪些协变量的问题。在传统方法中，只能选择所有寄存 器中可用的协变量。我们将这些称为完全观察到的协变量，并在第 7.2-7.3 节中描 述了方法。在第 7.4-7.5 节中，重点是仅在某些寄存器中可用的协变量（参见  Zwane 和 van der Heijden [34] 以及 van der Heijden 等人 [27]），我们将这些 称为不完整协变量。无论协变量在每个寄存器中是否可用，随着源和/或协变量数量 的增加，可以拟合的可能对数线性模型的数量会迅速增长。在第 7.6 节中，我们介 绍了一个应用程序，其中在概念上在两个寄存器中测量相同的变量， 但由于测量过程 不同，最好将它们视为不同的变量，这在分析不同来源的相似变量的一致性方面具有 可能的应用。最后，在第 7.7 节中，我们对提出的问题进行了一般性讨论。

# 7.2 关于不变种群规模估计的理论 

在本节中，我们研究了从包括协变量的对数线性模型得出的人口规模估计的（不）方 差，所有登记册中都有相同的协变量。首先，我们需要设置一些符号和术语。

## 7.2.1 术语和属性 

我们采用双重符号，其中包含在两个寄存器 A 和 B 中的内容也由变量 A 和 B 编码， 级别 A、B=0,1，其中级别 0 表示未注册，我们假设有 I 个分类协变量表示通过  $X_{i}$ ，其中 i = 1, ……， I .由变量A、B和 $ X_{1} $ 分类的列联表记为A    $\times$     B  $\times$   $X_{1}$   。我们使 用 Bishop、Fienberg 和 Holland [4] 的符号表示分层对数线性模型的最高拟合边 距。例如，在没有协变量的情况下，独立模型表示为 [A][B]，当有一个协变量 $X_{1}$时， 给定  $X_{1}$ ,A 和 B 条件独立的模型是  [A $X_{1}$ ]、[B $X_{1}$ ]。在这些模型中的每一个中，A 和 B 之 间的双因素相互作用不存在，这反映了引言中讨论的（条件）独立性假设，并且没有 附加信息就无法拟合双因素相互作用。 

模型中独立参数的数量不能大于观察计数的数量。当参数个数为双系统和多系统估计 

等于观察到的计数，我们有一个饱和模型，在这种情况下，模型的拟合值等于观 察到的计数。表 A  $\times$ B 具有单个结构零，因此存在三个观察到的计数，饱和模型 为 [A][B]（截距参数 A 和 B）。当有 I 个协变量时，表 A $\times$  B $\times$   $X_{1}$         $X_{I}$    的饱和模型 为 [[A $X_{1}$ . .  $X{I}$ ][B $X_{1}$ . . $X_{I}$ ]，其中 A 和 B 在给定协变量的情况下条件独 立。 

从任何多向列联表中，可以通过对其中一个边距求和（并因此从表中消除该 边距）来生成较小的表，这称为边缘化表。例如，从列联表 A $\times$ B  $\times$ 1开始，如果我 们对  $X_{1}$ 进行边缘化，我们将获得表 A  $\times$  B。 

当协变量的完整寄存器表可以在一个或多个协变量上被边缘化而不改变人口 规模估计时，我们会说该表（或模型）在这些协变量上是可折叠的。通过关注人 口规模估计，本文从不同于 Bishop、Fienberg 和 Holland [4] 的角度研究了 对数线性模型中的可折叠性，他们对参数可折叠性感兴趣。我们的工作应用了  Asmussen 和 Edwards [1] 的模型可折叠性，后来由 Whittaker [29] 和 Kim  和 Kim [16] 讨论，涉及模型拟合和边缘化的交换性。将可折叠性的想法应用于 包含结构零点的表是 van der Heijden 等人首先提出的一种新颖的扩展。 [27]。 

然后，我们区分被动协变量和主动协变量，前者在协变量上边缘化模型不会影响 人口规模估计，后者无法在不改变人口规模估计的情况下从模型中移除。虽然被动协 变量不影响大小估计，这表明它们可能会被忽略，但种群大小估计的次要目标是提供 亚种群大小的估计，或者等效地，根据给定的协变量分解种群大小，其中很可能包括 被动协变量。通过适当的可折叠模型创建被动协变量的人口细分是解决这一重要实际 问题的优雅方法。 

表格中的可折叠性以及相关的模型边缘化有两个我们希望研究的密切相关的推论： 

1. 存在对数线性模型，其表格在特定协变量上是可折叠的。 

2. 对于给定的列联表，存在不同的对数线性模型，它们产生相同的总人口规模估计。 

推论密切相关，因为如果推论 2 适用于列联表，那么它可以折叠在两个模型不常见 的协变量上。我们先用一个具体的例子来说明推论，然后给出解释。 

## 7.2.2 例子

我们以荷兰2011年人口普查质量评估为例，关注人群为15-64岁的阿富汗、伊朗或伊 拉克国籍人群；有关详细信息，请参阅 van der Heijden 等人。 [27]。在这种情况 下，A 是荷兰人口登记册 (GBA)，B 是警察登记册 (HKS)，我们使用两个协变量， $X_{1}$  

表示此人的性别，X2表示他们的年龄编码为四个频段（15-25、25-35、35-50 和 50- 64）。表 7.1 给出了一系列模型的估计值，这些模型可以拟合到生成的四向表中。 

表 7.1 说明了推论 1，即某些模型允许折叠 

特定协变量的表格。例如，模型  $M_{1}$ 产生与 $M_{0}$ 相同的人口规模估计，因此在  $M_{1}$ 下，A $\times$ B  $\times$  $X_{1}$ 表可折叠到  $X_{1}$  上。表 7.1 还显示了推论 2，即可以从一系列不同的模型中获得相 同的估计值——六种不同的模型产生 6,170.3 的估计值。事实上，我们可以进一步 推论 2，因为那里 

表 7.1 

模型范围内的对数线性模型规格、拟合统计数据和由此产生的人口规模估计（对于两 个登记册中未观察到的人口），考虑到结构零点，这些模型可以拟合到 A  $\times$  B  $X_{1}$   $\times$   $X_{2}$ 表。

![image-20230329122331221](C:\Users\酒霍尔\AppData\Roaming\Typora\typora-user-images\image-20230329122331221.png)
## 7.3.2 使用不变的人口规模估计

我们可以考虑人口规模不变的存在如何帮助选择合适的模型。 首先，重要的是要注意，如果两个模型在理论上产生相同的人口规模估计，那么它们在数值上同样稳定，具有相同的方差。 因此，效率不能被当做在人口规模估计不变的模型之间进行选择的标准。

其次，可用于在人口规模估计不变的模型之间进行选择的标准是模型拟合。 如果模型适用于相同的数据（即具有相同的协变量，因此具有相同的表大小），我们会选择更适合数据的模型。 例如，在表 7.1 中，模型 $M_5$ 、 $M_9$ 、 $M_{10}$ 、 $M_{12}$ 和 $M_{13}$ 均得出人口规模的估计值 5,696.1，并且它们都拟合到由变量 $A$、$B$ 、$X_1$ 和 $X_2$ 构建的四变量表。然而，选择的模型是 $M_{12}$ ，因为它具有最低的 AIC 值。 因此，我们想使用此模型分解为四向表估计的总人口规模，因为它提供了与四向表中观察值的最佳拟合。

请注意，对于拟合由变量 $A$ 、$B$ 和 $X_1$ 构建的三向表的模型 $M_3$ ，也发现了人口未观察部分的估计值 5,696.1。 这说明在四变量表中，变量 $X_2$ 在模型 $M_5$ 、 $M_9$ 、 $M_{10}$ 、 $M_{12}$ 和 $M_{13}$ 中是一个被动变量。 请注意，$M_3$ 是三变量表中的饱和模型，因此它具有完美拟合。 我们从模型 $M_5$ 、 $M_9$ 、 $M_{10}$ 、 $M_{12}$ 和 $M_{13}$ 的 AIC 测量中了解到，如果我们想用被动变量 $X_2$ 扩展模型 $M_3$ ，那么最好使用模型 $M_{12}$ 来实现。 该模型不仅具有最低的 AIC 值，而且具有 4.9 的偏差和 6 个自由度，具有足够的拟合度。

如果我们对像模型 $M_3$ 这样的三变量表模型感到满意，结果却没有一个模型，其中 $X_2$ 是被动变量，足以适合四变量表怎么办？ 尽管这种模型的拟合度不够，但该模型具有吸引人的特性，即该扩展模型的效率与模型 $M_3$ 的效率相同。 然而，这个扩展模型下的分解估计将有偏差，因为我们包括了一个影响拟合值的预测能力差的变量。

不变性还可以帮助饱和模型的正式模型选择（与 Elliott & Little [9] 相比）。 例如，在表 7.1 中，没有对模型 $M_0$ 和 $M_3$ 之间的选择进行统计检验，因为两者在 0 df 上都饱和了 0 偏差。 然而，当我们消除 $A$ 和 $X_1$ 之间或 $B$ 和 $X_1$ 之间的交互作用时，我们得到的模型 $M_1$ 和 $M_2$ 具有与模型 $M_0$ 相同的总人口规模估计值。 对于表 7.1 中的示例，$M_2$ 具有足够的拟合度，而模型 $M_1$ 具有不充分的拟合度。 这些结果表明，不提供模型 $M_0$ 的估计是明智的，因为 $M_0$ 没有说明应该如何对 $X_1$ 的值进行分解，而模型 $M_1$ 和 $M_2$ 的 AIC 度量表明只有 $M_2$ 的分解是足够的 . 如果模型 $M_1$ 和 $M_2$ 都具有不充分的拟合，那么模型 $M_3$ 应该优于模型 $M_0$ ，因为它已经饱和并且具有完美的拟合。

# 7.4 处理部分观察到的协变量

用于人口规模估计的登记表链接的第二个挑战是链接将产生缺失值。仅在登记表子集中可用的变量值对于不存在于该子集中的记录是未知的。在以下部分中，我们将介绍并探索一个架构，用于在一个过程中同时估计总量差额和补全这些缺失值。

 

## 7.4.1 部分观察到的协变量的人口规模估计框架

图 7.3 是两个寄存器之间联系的图形表示。该表示在行中显示带有观察值（通常是个人）的联系数据，在列中显示变量。左边是只在登记表 $A$ 中可用的变量的数据，用 $a$ 表示，右边是只在登记表$B$中的变量的数据，用 $b$ 表示，中间是登记表 $A$ 和 $B$ 共有的变量数据，用 $ab$ 表示。通常 $ab$ 包括用于链接登记表的变量。

因此，每个寄存器都有一些独特的变量，这些变量会导致观察到的案例中的数据缺失，如图 7.3 所示，以及为完全缺失的案例提供细分的要求，如上文所述。

我们将此视为数据缺失问题，并扩展对数线性模型来处理它。 我们注意到，估计缺失的协变量值仅对涉及所有登记表的协变量有意义。例如，如果人口登记册与医院登记册相关联，则不应为人口登记册中未出现在医院登记册中的所有个人估计医院登记册医疗问题的协变量类型，因为他们很可能根本没有医疗问题。

和以前一样，我们只考虑分类协变量，并允许扩展对数线性模型以包括协变量。这再次提供了在给定协变量的情况下具有独立性或条件独立性的灵活性，并扩大了第 7.1 节中的假设（估计完全缺失的总体规模仍然需要）的合理情况的范围。它还允许我们使用可以根据合适的协变量类别对该估计进行细分的模型。该问题通过应用期望最大化 (EM) 算法来估计人口规模估计的对数线性模型中缺失的观察值来解决。EM 算法是一个迭代过程，其中每次迭代都有一个期望 (E) 和一个最大化 (M) 步骤。在E-步骤中，缺失值的期望是在给定观察值和模型的拟合值的情况下找到的，这里是一些对数线性模型。E-步骤产生完整的数据。然后，在M-步骤中，将对数线性模型拟合到已完成的数据，这会更新在下一个E-步骤中使用的拟合值（有关更详细的描述，请参阅 van der Heijden 等人）。这会一直进行到收敛。该算法具有线性收敛性，这可能会使算法非常慢。然而，每一步的可能性都会增加，因此可以保证收敛。

 ![image-20230329161357048](C:\Users\Jiajun Zhang\AppData\Roaming\Typora\typora-user-images\image-20230329161357048.png)

表7.3 

两个有联系的登记表的图形表示，有关详细信息，请参见文本。

 

## 7.4.2 例子

我们使用两个不同的协变量扩展第 7.2.2 节中的示例：$X_3$ 代表婚姻状况，仅在寄存器 $A$ 中观察到，$X_4$ 代表被捕区域，我们将其解释为不完全测量的居住变量，仅在寄存器 $B$ 中观察到。得出的四向列联表如表7.3所示。

可以适合此表的最复杂（最大）模型是 $[AX_4][BX_3][X_3X_4]$ ，它有八个自由参数——一个截距、四个主效应和三个交互作用。这与表 7.3 中的计数相同，因此它是饱和的。 请注意，项 $AX_3$ 未包含在最大模型中，因为当 $A = 0$ 时，$X_3$ 缺失且未知。因此只有三个计数（两个单元格和一个边距）可用于项 $AX_3$ ，这没有足够的信息来识别它。 另请注意，无法测试违反此模型的情况，例如 $A$ 和 $B$ 之间以协变量为条件的依赖性，因为它已经饱和，因此额外的交互无法拟合。但是，可以调查输出对违反此假设的敏感性，请参阅第 7.5.2 节。也可以调查更严格的模型是否也适合数据。例如，我们可以研究是否可以在不恶化拟合的情况下消除其中一种交互作用，例如 $X_3X_4$ 。如果是这样，模型变为 $[AX_4][BX_3]$ ，并且在此模型下，$A$ 和 $B$ 是（无条件地）独立的，而不是独立于 $X_3$ 和 $X_4$ 的条件。这种条件独立性假设很强，但在许多数据集中可能没有足够的能力来检验其正确性。寄存器 $A$ 的被动协变量与 $B$ 中的被动协变量之间的直接关系只能在两个寄存器中的那些个体中进行评估。如果寄存器 $A$ 和 $B$ 之间的重叠比较大，则可以很容易地评估关系； 相反，如果重叠很小，则很难确定这种关系是否应包含在模型中。

当有额外的协变量时，可以轻松扩展最大模型。 例如，考虑这样的情况，除了在 $A$ 中观察到 $X_3$ 和在 $B$ 中观察到 $X_4$ 之外，在 $A$ 和 $B$ 中观察到一个变量 $X_5$ ； 那么最大和饱和模型是 $[AX_4X_5][BX_3X_5][X_3X_4X_5]$ 。

大多数寄存器都有几个协变量，这些协变量对于其他寄存器来说并不常见，因为不同的寄存器是为不同的目的而设置的。在这些情况下，我们可以扩展 7.3.1 节的建模策略：

首先，确定少量感兴趣的协变量，即与包含或不包含在一个或两个寄存器中相关的协变量。这可能需要一些主题知识；

其次，对这些协变量进行模型拟合过程，在最终模型中，其中一些协变量可能是主动的，另一些是被动的；

第三，使用（可能是几个）被动协变量扩展模型，这些协变量可能是也可能不是特定于寄存器的。

 

假设寄存器 $A$ 的被动协变量独立于以主动协变量为条件的寄存器 $B$ 的被动协变量，被动协变量有助于分解人口规模。这种方法在每个登记册都有独特的协变量但需要根据所有这些协变量描述整个人口的情况下特别有用。

 ![image-20230329162000237](C:\Users\Jiajun Zhang\AppData\Roaming\Typora\typora-user-images\image-20230329162000237.png)

表7.3

来自荷兰 2011 年人口普查质量评估的 15-64 岁具有阿富汗、伊朗或伊拉克国籍的人（参见 van der Heijden 等人）。 协变量 $X_3$（婚姻状况）仅在人口登记册 $A$ 中观察到，而 $X_4$（被捕的警区）仅在警察登记册 $B$ 中观察到。

 

## 7.4.3 具有不完整协变量的模型的交互图

具有不完整协变量的表的模型可以像以前一样使用交互图进行分析，但必须注意假设图可以与可用数据相匹配——因为单元格数量的减少意味着某些交互不能被拟合，正如我们 已经看过的那样。 例如，与图 7.1 中的 $M_{12}/M_{13}$ 具有相同图表的模型（但 $X_1$ 和 $X_2$ 分别由 $X_3$ 和 $X_4$ 代替）无法从表 7.3 中拟合，因为无法估计 $BX_3$ 项。

图 7.4 显示了选择具有两个和三个协变量的可能模型的交互图。 在模型 $I_5$ 中，只有一条短路径，并且两个协变量都在上面，因此模型不能在任何协变量上折叠。 在 $I_1$ 中有两条短路径 $A − X_3 − B$ 和另一条 $A − X_2 − X_1 − B$ （记住短路径不一定很短，但不包含子路径）； 由于所有协变量都出现在至少一条短路径上，因此模型再次无法在任何协变量上折叠。 $I_2$ 是一个缩减（非最大）模型，可以在 $X_2$ 和 $X_1$ 上折叠。



## 7.4.4 模型拟合结果

表 7.4 显示了将饱和 $[AX_4][BX_3][X_3X_4]$ 模型拟合到表 7.3 中的数据的拟合值。 计数 13,898 和 12,356 以及计数 91 和 164 已分布在缺失变量的水平上。 例如，13,898 在 $X_2$ 的水平上分布为 4,510.8 和 9,387.2，这两个计数的比率等于观察到的计数 259 和 539 的比率。因此，在表 7.4 中，计数 259 的优势比 , 539, 110 和 177（即左上角子表）被投影到右侧和底部的子表中，最多可以使用表 7.3 中的边距。



图7.4

表7.4.2所述的两种协变量和三种协变量模型示例的交互图。

![图7.4](C:\Users\86152\Desktop\大学课程\大二\应用抽样技术\图7.4.png)

表7.4

​	荷兰2011年人口普查质量评估(van der Heijden 等人[27])中年龄在15-64岁、具有阿富汗、伊朗或伊拉克国籍的人口，使用 $[AX_4][BX_3][X_3X_4]$ 模型的拟合值完成)，仅在警察登记册(HKS)中观察到。我们研究了这些模型如何允许人口登记册的覆盖率根据五个协变量进行评估。

![表7.4](C:\Users\86152\Desktop\大学课程\大二\应用抽样技术\表7.4.png)

​	表7.5显示了与部分或全部这些协变量拟合的模型的选择。模型 $N_1$ 是一个饱和模型，仅使用充分观察到的协变量。在这个模型中，对缺失部分人口规模的估计为5,504.6，总人口规模为33,098.6。然而，参数自举置信区间(Buckland and Garthwaite[5])表明该解在数值上是不稳定的，因为95%置信区间的上界是无限的。不稳定性是过多主动协变量的结果，一种解决方案是使协变量 $X_5$ 被动，例如在模型 $N_2 = [AX_1X_2][BX_1X_2X_5]$ 和 $N_3 = [AX_1X_2X_5][BX_1X_2]$ 中。注意，模型 $N_2$ 比模型 $N_3$ 更适合，但这对估计的总人口数没有影响。

​	模型 $N_2$ 和 $N_3$ 都可以通过包括婚姻状况( $X_3$ )或警区( $X_4$ )来扩展。当将 $N_2$ 扩展为加入 $X_3$ 和 $X_4$ 作为被动变量时，我们得到了模型 $N_4$ ，它产生了相同的种群大小估计，说明 $X_3$ 和 $X_4$ 确实是被动的。自由度为72，偏差为75.7，拟合良好。我们可以检查是否使协变量 $X_3$ 和 $X_4$ 活跃更好，我们通过添加它们之间的相互作用来给出模型 $N_5$ 。该模型的偏差没有变化，但使用了一个额外的df，因此其AIC更高，我们认为 $N_4$ 是一个比 $N_5$ 更好的工作模型。我们还通过添加 $X_3$ 和 $X_4$ 作为被动变量来扩展 $N_3$ ，从而得到 $N_6$ 。总体规模估计与预期的 $N_3$ 相同，但偏差比 $N_4$ 和 $N_5$ 大得多(我们无法与 $N_3$ 的偏差进行比较，因为它们来自不同的表)。加上 $X_3$ 和 $X_4$ 之间的相互作用，得到了改善偏差的 $N_7$ ，但它仍然大于 $N_4$ 的偏差，因此我们选择 $N_4$ 作为最终模型。

7.5精度和灵敏度

​	有两个估计问题（图7.3）：估计缺失的协变量和估计两个寄存器缺失的个体数量（及其协变量值）。对于这两个估计问题，我们感兴趣的是模型假设为真时的精度，以及结果对模型假设偏差的灵敏度。

7.5.1精度

​	缺失协变量估计的精度(这里是指估计的方差)取决于模型下优势比估计的精度。这个精度与 $A$ 和 $B$ 的总体规模直接相关:这个规模越大，优势比的标准误差和缺失协变量估计的标准误差就越小，精度就越好。

​	对于被 $A$ 和 $B$ 遗漏的个体的估计精度是两个来源的结果:第一，我们刚刚讨论的缺失协变量估计的精度，第二，隐含覆盖率。缺失协变量估计的精度直接影响缺失个体数据的精度。不精确的第二个来源与隐含的覆盖率有关。由表7.3可知， $B$ 隐含的登记册 $A$ 的人口覆盖率为 $259/(259 + 63.9)= 0.802$ 。但是， $A$ 暗示的警察登记册 $B$ 的覆盖率仅为 $259/(259 + 4510.8)= 0.057$ 。如果其中一个或两个隐含的覆盖率都很低，那么相对于所看到的个体数量，估计遗漏的个体数量就会很大，并且因此不精确。

​	精度的估计可以使用参数自举(Buckland和Garthwaite[5])获得。参数自举提供了一种简单的方法，可以在列联表未被完全观察时找到置信区间。为了计算特定对数线性模型的自举置信区间，首先计算该模型下的总体规模，从而计算完成数据的多项概率（表中每个单元格中的概率，总和为1）。用这些概率绘制完成总体规模的多项样本，然后将其聚合为与观测数据相同的形式（例如，从表7.4中绘制的样本聚合为表7.3的形式，包括插入结构零）。然后使用特定的对数线性模型拟合结果数据，给出总体大小的估计。这个过程重复 $L$ 次。通过对 $L$ 引导的总体规模估计进行排序，可以构造一个百分位置信区间。

表7.5

模型拟合到变量 $A,B$ 和 $X_1$ 到 $X_5$ 的例子，以及它们的偏差、自由度、AIC、估计总体规模和95%置信区间。

![表7.5](C:\Users\86152\Desktop\大学课程\大二\应用抽样技术\表7.5.png)

7.5.2 灵敏度

​	我们也感兴趣的估计的灵敏度违反模型的假设。很明显，研究最大模型是否可以通过设置一些参数为零来缩减是可能的。然而，由于没有足够的数据来估计，无法直接测试不包括在最大模型中的相互作用参数是否应该包括在内。Gerritse等人[12]表明，对于特定的数据集，我们可以研究最大模型的结果对某些参数为零的假设有多灵敏。例如在模型 $M_5$ 中， $AX_1$ 、 $BX_2$ 、 $AB$ 三个双因素相互作用和所有三因素、四因素相互作用均为零。假设我们感兴趣的是调查人口规模估计在多大程度上依赖于 $AX_1$ 相互作用为零的假设。对 $AX_1$ 相互作用扩展一个固定参数值的最大模型 $\lambda^{AX1} = k$ ，模型可拟合为带偏移量exp( $\lambda^{AX1}$ )的对数线性泊松回归。该模型可以拟合 $k$ 的一个值范围，并且可以利用对数线性参数与优势比密切相关的事实来选择合适的值。

​	Gerritse等人[14]认为，当隐含覆盖率较低时，分析结果对违反独立性假设和违反完美联系的灵敏度较大。在没有协变量的情况下，可以这样解释。设 $m_{ij}$ 为单元格 $(i,j)$ ( $i,j = 0,1$ )，其中 $m_{00}$ 为待估计的缺失数。在独立条件下，比值比为1，即 $m_{00}/m_{11}=m_{01}m_{10} = 1$ ，则 $m_{00} =m_{01}m_{10}/m_{11}$ 。在优势比 $\theta$ 依赖下， $m_{00}\theta = m_{01}m_{10}=m_{11}$ 。因此，单元格 $(1,1)$ 的重叠越小，覆盖率越小，单元格 $(0,0)$ 的估计值就越大，这对于独立和依赖都成立。同样，当链路缺失时，期望值 $m_{01}$ 和 $m_{10}$ 增大， $m_{11}$ 减小，结果 $m_{00}$ 增大，重叠 $m_{11}$ 越小，这种效应越大。

7.5.3 EM算法和经典模型的对比

​	Van der Heijden等人[26]进行了模拟，以比较忽略不完全协变量的经典模型(由标准对数线性模型(LL)表示)与用EM算法完成不完全协变量的模型(由EM表示)的行为。参考数据由具有四个变量（ $A$ 、 $B$ 、 $X_1$ 和 $X_2$ ）的总体生成，具有预先指定的边际概率。假设独立，这将导致16个概率，并使用这些模型拟合，其中预先指定的条件优势比被用作偏移量(见第7.5.2节)。该模型的拟合值被用作真实模型的概率，给出与独立模型的边际概率相同的边际概率和等于预先指定的条件优势比的条件优势比。
​	使用各种不同场景的模拟表明，当条件独立性假设得到满足时，EM方法比LL方法做得更好，尽管有时仅略好。当违反条件独立性假设时，两种方法的偏差都可能很大，特别是当一个或多个来源的包含概率(或等效的隐含覆盖率)很低时。

7.6 同一变量在两个寄存器中测量结果不同的应用程序

​	我们可以在两个寄存器都测量同一个变量的情况下应用这些方法，但其中一个寄存器中的测量被认为比另一个更可靠或有效。这与经典的两阶段抽样问题密切相关，其中有一种廉价但低质量的测量方法可以从大样本中获得，而一种更昂贵和更准确的方法则用于子样本。两相抽样侧重于将大样本测度的小抽样方差与小样本测度的测量精度相结合。作为一种替代方法，我们应用EM算法来完成最高质量测量的缺失信息，并为两个寄存器中缺失的统计单元提供这些信息(这种情况通常不能通过两阶段抽样来处理)。

7.6.1

​	我们使用的例子是荷兰交通事故中严重受伤的人数。在荷兰，重伤人数是用于评估道路安全目标的一项指标。关于严重道路伤害的信息有两个来源，即警察和医院，两者通常都在这类事故发生后参与。警察应该将事故及其原因记录在警察事故记录数据库中，但由于某些原因，这通常不会发生，比如不清楚哪位警察必须提交事故报告，或者受伤被认为不是很严重。治疗重伤者的医院可以在医院住院登记簿上报告受伤原因，但有时会忘记这一点，这样的病人与交通事故的联系就消失了。因此，两个寄存器都有覆盖问题;更多细节，参见Reurings和Stipdonk[22]。

​	对于2000年，Reurings和Stipdonk[22]给出了表7.6上表中的数据。警察登记的人数比医院登记的人数少。有理由认为，在警察登记册确实记录了运送受伤人员的方式的地方，他们比医院做得更准确，因为对承担责任的警察来说，评估事故原因比医院更重要，医院更关心与健康有关的问题，而不是事故的原因和细节。因此，我们将两个寄存器中的事故原因变量视为不同的变量，尽管它们测量的是相同的概念。请注意，在充分遵守的 $2\times2$ 子表中，有287个不一致的联合分类，即警方记录了涉及机动车辆，而医院记录了没有涉及机动车辆，反之则有29个。

一种方法是定义一个新的变量 $Y$ ，包含 $X_2$ 和 $B$ 的三个层次，即( $X_2 = 1,B = 1$ )，( $X_2 = 2,B = 1$ )和( $X_2 =$ 缺失)，然后拟合 $A = 0$ 缺失 $X_1$ 值的模型 $[AX_1][X_1Y]$ (见表7.6的面板2)。或者，我们可以使用EM算法方法，假设只有警察登记的事故中医院事故原因缺失，只有医院登记的事故中警察事故原因缺失，然后拟合模型 $[AX_2][BX_1][X_1X_2]$ (见表7.6的面板3)

(没完)

表7.6

2000年荷兰的交通事故，来自Reurings和Stipdonk[22]。涉及机动车 $X_1$ 仅在警察登记册(A)中可见，涉及机动车 $X_2$ 仅在医院登记册(B)中可见。 $X_1$ 和 $X_2$ 的级别为 $1 =是，2 =否$ 。

![表7.6](C:\Users\86152\Desktop\大学课程\大二\应用抽样技术\表7.6.png)
