####以下是由黄钰完成的：
### 3.4.4 例子
下面我们将介绍一些存在链接错误的两列表示例。\
$\quad\quad$ 例一：考虑表 $3.3$ 和 $3.4$ 中来自 $[23]$ 的数据,资料来源: $1990$ 年美国人口普查，相应的普查后枚举 $(PES)$ ，行政清单补充 $(ALS)$ ，用于 $PES$ 抽样在圣路易斯的第 $11$ 层普查，人口普查-$pes$捕获-再捕获数据载于表 $3.3$ ，匹配误差研究 $([42])$ 的结果见表 $3.4$ 。

**表3.3**
人口普查和 $PES$ 样本数据 $11$ 层，圣路易斯， $1990$ 年美国人口普查
<table>
<tr>
  <td colspan="2" align="center"></td>
  <td colspan="2" align="center">人口普查</td>
</tr>
<tr>
  <td colspan="2" align="center"></td>
  <td>目前</td>
  <td>缺失</td>
</tr>
<tr>
  <td>PES</td>
  <td>目前</td>
  <td>487</td>
  <td>129</td>
</tr>
<tr>
 <td></td>
 <td>缺失</td>
  <td>217</td>
  <td>-</td>
</tr>

</table>

**表3.4**
圣路易斯复赛研究
<table>
<tr>
  <td rowspan="2" align="center">原始匹配分类</td>
  <td colspan="3" align="center">复配分类</td>
  <td></td>
</tr>
<tr>
 <td>匹配</td>
  <td>不匹配</td>
  <td>未解决的</td>
  <td>总计</td>
</tr>
<tr>
  <td>匹配</td>
  <td>2667</td>
  <td>7</td>
  <td>8</td>
  <td>2682</td>
</tr>
<tr>
 <td>不匹配</td>
 <td>9</td>
  <td>427</td>
  <td>30</td>
  <td>466</td>
</tr>
<tr>
 <td>未解决的</td>
 <td>0</td>
  <td>7</td>
  <td>20</td>
  <td>27</td>
</tr>
<tr>
 <td>总计</td>
 <td>2676</td>
  <td>441</td>
  <td>58</td>
  <td>3175</td>
</tr>

</table>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: {inlineMath: [['$', '$']]}, messageStyle: "none" });
</script>

$\quad\quad$ 将复赛结果视为真实，忽略未解决的情况，如 $[23]$ ，失配率为 $1-\hat{\alpha}=9/(2667+9)=0.3363 \% $ ，假链接率是 $\hat{\beta}=7/(7+427)=1.6129 \% $ 。表 $3.3$ 的标准 $DSE$ 结果为 $890$ ，标准误差 $(SE)$ 为 $10.25$ 。结合连杆误差，我们得到 $ \widetilde {N}_{DF}=891$ (以及 $SE=10.29$ )。由于错误率低，调整很小，并且根据 $SE_s$ ​，两个估计值没有显著差异。请注意，由于丢失匹配的比率非常低，原始的 $DSE$ 实际上是向上调整的。
$\quad\quad$ 将两个错误率直接代入 $(3.16)$ ， $MDF$ 估计值为 $ \widetilde {N}_{MDF}=898$ (以及 $SE=10.64$ )。但是，鉴于表 $3.3$ 实际上是由 $PES$ 与人口普查的单向联系产生的，在这种情况下 $MDF$ 估计数是无效的，就像它提到的 $5.5 \approx(129+217) \times \beta$ 487个实际链接中的虚假链接，而数字为 $2 \approx 129 \times \beta$ 符合单向联动程序。这里只计算$MDF$估计及其$SE$，以说明所涉及的计算。
$\quad\quad$ 例二： 考虑$[16]$中描述的案例，其中有来自两个道路事故死亡事件登记册的数据。由于它们的尺寸较小，可以通过文书审查对链接结果进行完整的分析。道路意外登记册$(RAR)$记录了道路意外的动态和情况，并与死因登记册 $(RCD)$ 相连。关联过程并不简单:没有通用的个人识别代码，而且由于$RAR$参考单位是道路事故，当涉及多人时，个人识别变量(即姓名、姓氏、年龄)有时会丢失或错误。$RAR$有$4237$条记录，$RCD$有$4642$条记录。用于联系的变量包括道路交通受害者/死者的姓名、姓氏和年龄，以及事故/死亡的日期、月份、直辖市和省份。数据大小不需要缩减程序，所有可能的记录对都被检查。可能链接的整个空间也通过文书审查来探索概率过程所遗漏的链接。链接过程标识$3129$条链接记录。估计$Fellegi-Sunter (FS)$联动错误率为$(3.7)和(3.8)$，由 $ \hat { \beta }=0.00$ 和 $1-\hat{\alpha}=0.15$ 得出。通过联动后对联动状态的文书复核，我们可以评估真实的联动错误率(表$3.5$)，其中真实的 $1−\alpha$ 为 $0.1141$ ， $\beta$ 为 $0.0011$ 。

**表3.5**
真实联动状态与概率联动结果的比较
<table>
<tr>
  <td colspan="2" rowspan="2" align="center"></td>
  <td colspan="2" align="center">真实联动状态</td>
  <td rowspan="2" align="center">总计</td>
</tr>
<tr>
  <td>匹配</td>
  <td>不匹配</td>
</tr>
<tr>
<td rowspan="2" align="center">概率联系</td>
  <td>联系</td>
  <td>3127</td>
  <td>2</td>
  <td>3129</td>
</tr>
<tr>
 <td>不联系</td>
 <td>403</td>
  <td>-</td>
  <td>2621</td>
</tr>
<tr>
  <td colspan="2" align="center">总计</td>
 <td>3530</td>
  <td>1819</td>
  <td></td>
</tr>
</table>

此外，使用经过文员审查的真实链接，道路死亡总人数的死亡影响指数为$5572$，而现有的死亡影响指数为$6286$。
$\quad\quad$由$MDF$估计器得到的种群规模估计为$5571$使用真实的链接错误率，而使用$FS$估计的错误率为$5330$。正如可以预料的那样，$DF$估计值实际上与$MDF$估计值相同，因为$\beta$几乎为零。然而，$DF$估计器在非零的假链接率下是无效的，因为在这种情况下，链接过程不是单向的。原始的$DSE$是高估的，几乎完全是由于错过匹配，这是偏差的主要来源。
$\quad\quad$值得注意的是，$\beta$和$1-\alpha$的评价并不是直接的，当真正的联动状态仅为一个训练集所知时的链接，但不是所有可能链接的整个空间。例如，众所周知的$[5]$方法只提供了$\beta$的估计值。$[61]$提出的方法对$\beta$和$1-\alpha$进行了估计，但没有对连杆权值进行强分布假设。
$\quad\quad$例三： 本例说明了计算野生动物种群的贝叶斯不确定性传播。数据报告在$[38]$中，收集自美国弗吉尼亚州谢南多亚山谷的大理石纹蝾螈研究(详细信息见$[2]$)。在本研究中，捕获是通过背部模式的照片来实现的，并使用计算机辅助模式匹配软件来识别个体并构建捕获-再捕获数据(表$3.6$)。在$9$月初成年蝾螈产卵的池塘迁徙前后进行了两次捕捉。

**表3.6**
在美国弗吉尼亚州谢南多亚山谷重新捕获大理石纹蝾螈
<table>
<tr>
  <td rowspan="2" align="center">第一次捕获</td>
  <td colspan="2" align="center">第二次捕获</td>
  <td rowspan="2" align="center">总计</td>
</tr>
<tr>
  <td>目前</td>
  <td>缺失</td>
</tr>
<tr>

  <td>目前</td>
  <td>174</td>
  <td>22</td>
  <td>196</td>
</tr>
<tr>
 <td>缺失</td>
 <td>383</td>
  <td>-</td>
  <td></td>
</tr>
<tr>
  <td>总计</td>
 <td>537</td>
  <td></td>
  <td></td>
</tr>
</table>

$\quad\quad$如前面所提到的，在像这样的生态学研究中，错误的主要风险是对自然标签的错误识别，即缺失匹配率 $\alpha$，根据链接$[38]$的术语产生“幽灵”记录。这样，确定的匹配值就会过低，而估计的种群大小就会过高。
$\quad\quad$表$3.6$中的数据有四个未知参数，分别是两种情况下的捕获概率$\pi1$和$\pi2$，总体规模$N$和误识别错误率$\alpha$。该模型已超过参数化。$Link$等人$(2010,p.183)$考虑了几种选择:
$1.$忽略$\alpha$，应用最原始的$DSE$;
$2.$在$\pi1$=$\pi2$约束下，拟合$\alpha$模型;
$3.$对$\alpha$进行贝叶斯分析。

根据表$3.6$中的数据，第二种选择显然是不可防御的。第一种选择实际上是第三种选择的特殊情况，在$\alpha$上有一个点质量更优。$[38]$在咨询了现场专家后，确定了$\pi1$、$\pi2$和N的均匀先验，$\alpha$的$\beta(19,1)$先验分布表明了较高但不完美的识别率。然而，$\alpha$的均匀、$\beta(10,1)$、$\beta(19,1)$先验导致几乎相同的$95\%$可信区间，详情见$[38]$。
$\quad\quad$表$3.7$提供了结果的摘要。N的后验分布由吉布斯采样器$([38])$得到。给出了$N$后验分布的中位数、第$2.5^{th}$百分位和第97.5百分位$\alpha$的先验。为了进行比较，还计算了$MLE$和相关的置信度，将预期$\alpha$在其先验分布下处理，就好像它是已知的一样。请注意，最后一行中的$MLE$对应于原始的$DSE$，它忽略了识别错误，而调整后的$MLE$不能为第一行中的期望值$\alpha$计算，因为调整后的真匹配数大于第一次捕获的总数。

**表3.7**
$\alpha$备选先验下$N$的估计值
| $\alpha$ 的先验    | $N$ 的后中位数（ $2.5^{th}$ , $97.5th$ 百分位）    | $\alpha$ 期望值    | $MLE$ 和 $0.05 \% $ 置信区间     |
| -------- | -------- | -------- |-------- |
| $\beta(1,1)$ | $569(538,616)$ | $0.50$ |-|
| $\beta(10,1)$ | $573(538,618)$ | $0.91$ | $550(540,560)$ |
| $\beta(19,1)$ | $578(539,620)$ | $0.95$ | $575(557,502)$|
| $\beta(100,1)$ | $595(557,628)$ | $0.99$ | $599(575,623)$|
| $\beta(\infty,1)$ | $606(585,636)$ | $1$ | $605(580,630)$|

$\quad\quad$我们注意到置信区间的长度随着$\alpha$而减小，如果$\alpha$是已知的，这是可以理解的，因为它意味着真实匹配的数量是已知的，并且在两个列表大小固定的情况下不断增加。然而，在这种情况下，将规定的$\alpha$视为已知的显然是误导。贝叶斯后验不确定性随着$\alpha$的先验期望的降低而增加，这是由于先验分布在其中心周围变得不那么集中。对于比$\beta(19,1)$更不确定的先验，结果表明$(i)$后验$95\%$区间相对于先验的选择是稳健的，$(ii)$后验中位数是比后验均值更稳健的点估计选择。
$\quad\quad$例三： 为了进行比较，在$[16]$中提出了仿真研究不同联动情景下的估计量，突出了标准捕获-再捕获估计的偏差。模拟中使用的虚构数据模拟了覆盖范围不足的寄存器以及链接变量$[41]$中存在的错误。这两份清单分别根据 $\tau_1= 0.930$和 $\tau_2= 0.924$随机生成。这两个列表被连接在一起，假设了三种不同的情况。黄金情景使用具有最高识别能力的链接变量，即姓名、苏尔$(Sur)$名称、完整出生日期。这在错误率方面给出了最好的结果，其中$\alpha=0.939， \beta=0.001$。银色场景代表了最强有力的可识别变量(即姓名和姓氏)不可用的情况，例如，由于隐私保护可能会出现这种情况。链接过程以完整出生日期为基础。这导致了比黄金情景更高的链接错误率，其中 $\alpha=0.851，\beta=0.101$。最后，青铜场景在链接错误方面是最不利的，由于附加的链接变量的错别字和缺失值。所得$\alpha$和$\beta$的平均值分别为$0.833和0.108$。有原始的$DSE$,$DF$和$MDF$估计量彼此比较，其中$DF$和$MDF$估计器是使用每次复制中的$\alpha$和$\beta$的真实值计算的。结果还与不受连锁误差影响的真实$DSE$进行了比较。
$\quad\quad$在黄金情景中，假链接误差几乎不存在，恰当的估计器减少了原始$DSE$的偏差，正如可以预期的那样，在这种情况下$DF$和$MDF$非常接近。在银色场景中，虚假链接率$\beta$不再可以忽略，$MDF$明显优于形成替代估计器，其中$DF$估计器是不合适的，因为链接不是单向的。$MDF$估计器的改进在具有较高假链接率的青铜场景中更加明显。有关复制设置和结果的详细信息，请参见$[16]$。

**表3.8**
3-list链接单元计数表
<table>
<tr>
  <td></td>
  <td colspan="4" align="center">列表1</td>
</tr>
<tr>
  <td></td>
  <td colspan="2" align="center">目前</td>
  <td colspan="2" align="center">缺失</td>
</tr>
<tr>

  <td></td>
  <td colspan="2" align="center">列表3</td>
  <td colspan="2" align="center">列表3</td>
</tr>
<tr>
 <td>列表2</td>
 <td>目前</td>
  <td>缺失</td>
  <td>目前</td>
  <td>缺失</td>
</tr>
<tr>
  <td>目前</td>
 <td>n*111</td>
  <td>n*110</td>
  <td>n*011</td>
  <td>n*010</td>
</tr>
<tr>
  <td>缺失</td>
 <td>n*101</td>
  <td>n*100</td>
  <td>n*001</td>
  <td>n*000</td>
</tr>
</table>

## 3.5 在多个列表的情况下，链接错误调整
本节研究了连锁误差的影响，并提出了基于第$3.2$节中介绍的多次重捕获和线性模型的群体规模估计量的调整。

### 3.5.1 基于对数线性模型的估计器
我们从表$3.8$中的$3$列表链接数据开始，其中$n^*_{ijk}$是基于链接数据的单元数，$\pi^*_{ijk}$​是对应的单元概率，对于$i,j,k=1,0,$$n^*_{ijk}$​根据定义是不可观察的。该表的排列方式与表$3.2$中真实的捕获-再捕获数据相同。链接错误“扰乱”了表$3.2$中的数据，因此$n^*_{ijk}$​可能与$n_{ijk}$​不同，除了列表总数,$n_{1++}​，n_{+1+}$​和$n_{++1}$​。设$n$为所有观察到的不同单元的数目，也假设不受联动误差的影响。
$\quad\quad$$Fienberg$和$Ding$$[23]$提出了对数线性模型的修正，该模型考虑了从真实构型$n$到已观测构型的可能转变，只考虑了缺失的环节。他们假设:
$(i)$联动过程中无错误匹配;
$(ii)$一个过渡最多只能向下走一层;
$(iii)$保持原始状态(没有遗漏错误)的概率等于$\alpha$和跃迁到任何其他可能状态的概率等于$(1−\alpha)/(m−1)$，其中m是所有可能跃迁到且允许跃迁的可能状态的数目。

例如，在所有三个列表$(111)$中真实记录的个体可以以相同的概率$(1−\alpha)/3$产生以下模式{$(110)，(001)$}或{$(101)，(010)$}或{$(011)，(100)$}。
$\quad\quad$类似地，{$(110)，(001)$}可以被观察为{$(110)，(001)$}或{$(100)，(010)，(001)$}，以此类推。这个公式可以很容易地扩展到一般的$k$列表数据。允许的转换结构产生了一个方程，该方程将链接表的单元概率关系式$(\pi \times = M\pi)$与真实表的单元概率关系式$(\pi \times = M\pi)$联系起来，并乘以$N$，得到期望的单元数为$E(N \times | N) = Mn$。
$\quad\quad$为了估计总体规模$N$, $Fienberg$和$Ding$$[23]$建议根据给定$N$的条件似然计算$\pi$的$MLE$，如第$3.4.1$节所述。由$[51]$可知，条件$mle$和无条件$mle$在合适的正则条件下都是一致的。然后得到$n000$和NN的$mle$，如$3.2$节中$[22]$所述。
$\quad\quad$董事会和导师$[17]$提出了一个扩展，以允许虚假链接除了丢失匹配。此外，他们还采用了一种误差模型，考虑到第$3.3.1$节所述的三清单联系程序的拟议操作模型，其中清单$1$和清单$2$首先相连，然后与清单$3$相连。
$\quad\quad$因此，设$1−\alpha_1$为第一个匹配失败的概率连杆，并假设错过一个匹配的概率在第二连杆与第一个连杆操作$1−\alpha_2$的结果无关。同理，设$\beta_1$​和$\beta_2$​为两个键的假连接概率，分别假设错误链接的概率不依赖于第一个操作的结果。区分链接的两个操作中的错误是由不同列表中不同的关键变量质量驱动的。
$\quad\quad$需要再一次考虑$n_{111}$​。当只允许缺少匹配时，可能的从真实匹配模式$(111)$到观察到的模式的转换如下:

{$(111)$} &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;概率$\alpha_1\alpha_2$
{$(110),(001)$} &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;概率$\alpha_1(1-\alpha_2)$
{$(101),(010)$}或者{$(100),(011)$} &emsp;&emsp;概率$(1-\alpha_1)\alpha_2/2$
{$(100),(010),(001)$} &emsp;&emsp;&emsp;&emsp;概率$(1-\alpha_1)(1-\alpha_2)$


将所有其他真实匹配模式相似地放在一起，表$3.9$给出了从表$3.2$中的真实数据到表$3.8$中的观测数据的转换矩阵。

**表3.9**
从真实模式到观察模式的转换矩阵，只有缺失的环节
| |$(111)$ | $(110)$ |$(101)$  |$(100)$ |$(011)$ |$(010)$ |$(001)$ |
| -------- | -------- | -------- |-------- |------- |------- |------- |------- |
| $(111)^*$ | $\alpha_1\alpha_2$ |  ||  |  |  |  |
| $(110)^*$|$\alpha_1(1-\alpha_2)$  | $\alpha_1$ |  |  |  |  |  |
| $(101)^*$ | $(1-\alpha_1)\alpha_2/2$ |  | $\alpha_2$ |  |  |  |  |
| $(100)^*$| $(1-\alpha_1)(2-\alpha_2)/2$ | $1-\alpha_1$ | $1-\alpha_2$ | $1$ |  |  |  |
| $(011)^*$ | $(1-\alpha_1)\alpha_2/2$ |  |  |  | $\alpha_2$ |  |  |
| $(010)^*$ | $(1-\alpha_1)(2-\alpha_2)/2$  |  $1-\alpha_1$|  |  |  | $1$ |  |
| $(001)^*$ | $1-\alpha_2$ |  | $1-\alpha_2$ |  |  $1-\alpha_2$|  |  $1$|

$\quad\quad$接下来，可以扩展转换矩阵以包括假链接误差(表$3.10$)。此外，在每个阶段，只要错过了一个真匹配，就不会出现一个假链接，因为当至少同时出现两个错误时，就会发生此事件，类似于第$3.4.1$节和第$3.4.2$节中两个列表的情况。最后，正如第$3.3.2$节中已经提到的，请注意，在表$3.10$中，假链接率是使用分母$(N_1−n_{11})+(N_2−n_{11})$来评估的，即列表$1$或列表$2$中不匹配的记录的数量以及$(n_{11}−n_{111})+(N_3−n_{111})$，其中n_{11}n11​表示在第一个列表之后的新列表

**表3.10**
转换矩阵从真实模式到观察模式，缺失和错误的链接
| |$(111)$ | $(110)$ |$(101)$  |$(100)$ |$(011)$ |$(010)$ |$(001)$ |
| -------- | -------- | -------- |-------- |------- |------- |------- |------- |
| $(111)^*$ | $\alpha_1\alpha_2$ | $\alpha_1\beta_2$ |$\alpha_2\beta_1$| $\beta_1\beta_2$ | $\alpha_2\beta_1$ |  |  |
| $(110)^*$|$\alpha_1(1-\alpha_2)$  | $(\alpha_1)(1-\beta_2)$ | $\beta_1(1-\alpha_2)$ | $(\beta_1)(1-\beta_2)$ | $\beta_1(1-\alpha_2)$ |  |  |
| $(101)^*$ | $(1-\alpha_1)(\alpha_2)/2$ | $(1-\alpha_1)\beta_2/2$ | $(1-\beta_1)(\alpha_2)$ | $(1-\beta_1)(\beta_2)$ |  |  |  |
| $(100)^*$| $(1-\alpha_1)(2-\alpha_2)/2$ | $(1-\alpha_1)(1-\beta_2/2)$ | $(1-\beta_1)(1-\alpha_2)$ | $(1-\beta_1)(1-\beta_2)$ | $-\beta_1$ |  |  |
| $(011)^*$ | $(1-\alpha_1)(\alpha_2)/2$ | $(1-\alpha_1)\beta_2/2$ |  |  | $(1-\beta_1)\alpha_2$ |  |  |
| $(010)^*$ | $(1-\alpha_1)(2-\alpha_2)/2$  |  $(1-\alpha_1)(1-\beta_2/2)$| $-\beta_1$ | $-\beta_1$ | $(1-\beta_1)(1-\alpha_2)$ | $1$ |  |
| $(001)^*$ | $1-\alpha_2$ | $-\beta_2$ | $1-\alpha_2$ | $-\beta_2$ |  $1-\alpha_2$|  |  $1$|

